DROP KEYSPACE BOOK;
DROP KEYSPACE USER;
DROP KEYSPACE WRITER;

CREATE KEYSPACE BOOK
WITH replication = { 'class' : 'SimpleStrategy' , 'replication_factor' : 3};

CREATE KEYSPACE USER
WITH replication = { 'class' : 'SimpleStrategy' , 'replication_factor' : 3};

CREATE KEYSPACE WRITER
WITH replication = { 'class' : 'SimpleStrategy' , 'replication_factor' : 3};

CREATE TABLE BOOK.BOOK_GENRE(
BOOK_ID SMALLINT,
BOOK_NAME TEXT,
GENRE TEXT,
YEAR INT,
PRIMARY KEY((GENRE), YEAR))
WITH CLUSTERING ORDER BY (YEAR ASC);

CREATE TABLE BOOK.BOOK_RATING(
BOOK_ID SMALLINT,
BOOK_NAME TEXT,
RATING INT,
PRIMARY KEY((BOOK_ID)));

CREATE TABLE USER.USER_AGE(
USER_ID SMALLINT,
USER_NAME TEXT,
AGE INT,
PRIMARY KEY((USER_ID)));

CREATE TABLE USER.USER_BOOK(
USER_ID SMALLINT,
USER_NAME TEXT,
BOOK_ID SMALLINT,
BOOK_NAME TEXT,
RATING INT,
PRIMARY KEY((USER_ID), RATING))
WITH CLUSTERING ORDER BY (RATING ASC);

CREATE TABLE WRITER.WRITER_BOOK(
WRITER_ID SMALLINT,
WRITER_NAME TEXT,
BOOK_ID SMALLINT,
BOOK_NAME TEXT,
YEAR INT,
PRIMARY KEY(WRITER_ID, BOOK_ID));

INSERT INTO
BOOK.BOOK_GENRE(BOOK_ID, BOOK_NAME, GENRE, YEAR)
VALUES (1, 'The Adventures of Sherlock Holmes', 'Detective', 1892);
INSERT INTO
BOOK.BOOK_GENRE(BOOK_ID, BOOK_NAME, GENRE, YEAR)
VALUES (2, 'And Then There Were None', 'Detective', 1939);
INSERT INTO
BOOK.BOOK_GENRE(BOOK_ID, BOOK_NAME, GENRE, YEAR)
VALUES (3, 'Professor Dowells Head', 'Science fiction', 1925);
INSERT INTO
BOOK.BOOK_GENRE(BOOK_ID, BOOK_NAME, GENRE, YEAR)
VALUES (4, 'The Colour of Magic', 'Fantasy', 1983);
INSERT INTO
BOOK.BOOK_GENRE(BOOK_ID, BOOK_NAME, GENRE, YEAR)
VALUES (5, 'The Light Fantastic', 'Fantasy', 1986);
INSERT INTO
BOOK.BOOK_GENRE(BOOK_ID, BOOK_NAME, GENRE, YEAR)
VALUES (6, 'War and Peace', 'Novel', 1869);


INSERT INTO
BOOK.BOOK_RATING(BOOK_ID, BOOK_NAME, RATING)
VALUES (1, 'The Adventures of Sherlock Holmes', 5);
INSERT INTO
BOOK.BOOK_RATING(BOOK_ID, BOOK_NAME, RATING)
VALUES (2, 'And Then There Were None', 4);
INSERT INTO
BOOK.BOOK_RATING(BOOK_ID, BOOK_NAME, RATING)
VALUES (3, 'Professor Dowells Head', 5);
INSERT INTO
BOOK.BOOK_RATING(BOOK_ID, BOOK_NAME, RATING)
VALUES (4, 'The Colour of Magic', 5);
INSERT INTO
BOOK.BOOK_RATING(BOOK_ID, BOOK_NAME, RATING)
VALUES (5, 'The Light Fantastic', 4);
INSERT INTO
BOOK.BOOK_RATING(BOOK_ID, BOOK_NAME, RATING)
VALUES (6, 'War and Peace', 3);

INSERT INTO USER.USER_AGE(USER_ID, USER_NAME, AGE)
VALUES(1, 'POLINA', 22);
INSERT INTO USER.USER_AGE(USER_ID, USER_NAME, AGE)
VALUES(2, 'MAXIM', 26);
INSERT INTO USER.USER_AGE(USER_ID, USER_NAME, AGE)
VALUES(3, 'EVGENIA', 17);

INSERT INTO USER.USER_BOOK(USER_ID, USER_NAME, BOOK_ID, BOOK_NAME, RATING)
VALUES(1, 'POLINA', 3, 'Professor Dowells Head', 5);
INSERT INTO USER.USER_BOOK(USER_ID, USER_NAME, BOOK_ID, BOOK_NAME, RATING)
VALUES(3, 'EVGENIA', 3, 'Professor Dowells Head', 4);
INSERT INTO USER.USER_BOOK(USER_ID, USER_NAME, BOOK_ID, BOOK_NAME, RATING)
VALUES(1, 'POLINA', 6, 'War and Peace', 1);
INSERT INTO USER.USER_BOOK(USER_ID, USER_NAME, BOOK_ID, BOOK_NAME, RATING)
VALUES(3, 'EVGENIA', 6, 'War and Peace', 2);
INSERT INTO USER.USER_BOOK(USER_ID, USER_NAME, BOOK_ID, BOOK_NAME, RATING)
VALUES(2, 'MAXIM', 2, 'And Then There Were None', 4);
INSERT INTO USER.USER_BOOK(USER_ID, USER_NAME, BOOK_ID, BOOK_NAME, RATING)
VALUES(2, 'MAXIM', 5, 'The Light Fantastic', 3);
INSERT INTO USER.USER_BOOK(USER_ID, USER_NAME, BOOK_ID, BOOK_NAME, RATING)
VALUES(1, 'POLINA', 5, 'The Light Fantastic', 4);
INSERT INTO USER.USER_BOOK(USER_ID, USER_NAME, BOOK_ID, BOOK_NAME, RATING)
VALUES(3, 'EVGENIA', 1, 'The Adventures of Sherlock Holmes', 5);
INSERT INTO USER.USER_BOOK(USER_ID, USER_NAME, BOOK_ID, BOOK_NAME, RATING)
VALUES(3, 'EVGENIA', 4, 'The Colour of Magic', 5);
INSERT INTO USER.USER_BOOK(USER_ID, USER_NAME, BOOK_ID, BOOK_NAME, RATING)
VALUES(1, 'POLINA', 4, 'The Colour of Magic', 5);

INSERT INTO WRITER.WRITER_BOOK(WRITER_ID, WRITER_NAME, BOOK_ID, BOOK_NAME, YEAR)
VALUES(1, 'Arthur Conan Doyle', 1, 'The Adventures of Sherlock Holmes', 1892);
INSERT INTO WRITER.WRITER_BOOK(WRITER_ID, WRITER_NAME, BOOK_ID, BOOK_NAME, YEAR)
VALUES(2, 'Alexander Belyayev', 3, 'Professor Dowells Head', 1925);
INSERT INTO WRITER.WRITER_BOOK(WRITER_ID, WRITER_NAME, BOOK_ID, BOOK_NAME, YEAR)
VALUES(3, 'Agatha Christie', 2, 'And Then There Were None', 1939);
INSERT INTO WRITER.WRITER_BOOK(WRITER_ID, WRITER_NAME, BOOK_ID, BOOK_NAME, YEAR)
VALUES(4, 'Terry Pratchett', 4, 'The Colour of Magic', 1983);
INSERT INTO WRITER.WRITER_BOOK(WRITER_ID, WRITER_NAME, BOOK_ID, BOOK_NAME, YEAR)
VALUES(4, 'Terry Pratchett,', 5, 'The Light Fantastic', 1986);
INSERT INTO WRITER.WRITER_BOOK(WRITER_ID, WRITER_NAME, BOOK_ID, BOOK_NAME, YEAR)
VALUES(5, 'War and Peace', 1, 'Leo Tolstoy', 1869);



